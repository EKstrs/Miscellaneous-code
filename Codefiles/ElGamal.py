def decipher(C1, a, p):
    shared_secret = pow(C1, a, p)
    message_integer = (C2 * pow(shared_secret, -1, p)) % p
    return message_integer
    

p = 173102947261786611502645652849703996365423190940002083774458559285894570985309885631656885966998043476405540150866852465812805714870985893628315846803013717243861790875625508614535673889381565194968919407526045905470567000477455705366848641605040094487895017693887293745350379644268430152130850067709987836971 
g = 2
#Alice's Public Key 
A = 30260337088178337195725811616947635693533708365538099653711659149437749700964795585332068859732438455505449718422384281229429020701866264810425053835359595454393944022905884696970182747489901955158502140793042951870126540906445654413330930070140913818458306573064767081407610703209552780472767323993140885129
#Alice's Private Key, 
a = 77157944476793518221944713043143940898336687224896204364017116013683027860173196829898773981376274865638707886195747459496177713383112854271949123017472903383593219992689815695104086243806101029595318633236774577576852891324039530545381404899196352680209828101860988975587088400760260985903048362242087388134
#Bob's Ephemeral Public Key, 
C1 = 31093435689706598117477228036288392515948534626183133910433039270252277303119741465447712039552484415938049671630654742454536128697216059897182278887024697153356312436657941688299425136226797212511132145621556436969808049894062298461604664987317092686566612187555734383531041530248780631804839909984999971628
#Bob's Ephemeral Key, 
k=85876698044814991720332888312921051012660640157748632697872553886528509717626352910082337734206715470895226904913680751730220107619186739047872725103940296576485897604250306367463227830659481404360493652055122364335647970763679532975481761575135522156841864472275175665980299781203316538936533245689544611566
#Encrypted message, 
C2=163645692741518143139796905756851263722513854645095258827692441562070454867157026811760110730807529378947018207729236845251254569629914146501210781839718664448739787285696522194680487556649487567355135284304194214354860142246022429535363184089070085277451041769296975595832601060592407017525578510371022396146



message = decipher(C1, a, p)

M_bytes = message.to_bytes((message.bit_length() + 7) // 8, 'big')
M = M_bytes.decode('utf-8')

print(M)

